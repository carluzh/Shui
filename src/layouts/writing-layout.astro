---
import MainLayout from "./main-layout.astro";
import ArticleHeader from "@/components/ArticleHeader.astro";
import Footer from "@/components/footer.astro";

const { title, description, date, slug, headings, colorClass, image } = Astro.props;

// If image is not provided, fallback to a default OG image path
const ogImage = image || `/images/Adam.png`;

---

<MainLayout
  title={title}
  description={description}
  author="Shui"
  image={ogImage}
  headings={headings}
  baseUrl={import.meta.env.BASE_URL}
>
  <article class={`mx-auto max-w-2xl writing-content ${colorClass}`}>
    <ArticleHeader title={title} date={date} />
    <script async src="https://eocampaign1.com/form/53752fd4-7c48-11ef-8a64-1d42c2f1a502.js" data-form="53752fd4-7c48-11ef-8a64-1d42c2f1a502"></script>
    <script async src="https://eocampaign1.com/form/83c19bd0-7c45-11ef-888c-b955cf7f7dc9.js" data-form="83c19bd0-7c45-11ef-888c-b955cf7f7dc9"></script>
    <div class="prose prose-lg dark:prose-invert mt-4 sm:mt-8">
      <slot />
    </div>
    <div class="mt-8 mb-2">
      <div id="lottie-container"></div>
    </div>
    <Footer />
  </article>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const links = document.querySelectorAll('.writing-content a');
      links.forEach(link => {
        const href = link.getAttribute('href');
        if (href && !href.startsWith('#') && !href.startsWith('/')) {
          link.setAttribute('target', '_blank');
          link.setAttribute('rel', 'noopener noreferrer');
        }
      });
    });
  </script>
  
</MainLayout>

<script>
  import lottie from 'lottie-web';

  document.addEventListener('astro:page-load', () => {
    const container = document.getElementById('lottie-container');
    if (container) {
      lottie.loadAnimation({
        container: container,
        renderer: 'svg',
        loop: true,
        autoplay: true,
        path: '/animations/1.json' // Make sure this path is correct
      });
    }
  });
</script>

<style>
  .writing-content {
    font-size: 0.9em !important;
  }

  .writing-content .prose.prose-lg h1,
  .writing-content .prose.prose-lg h2,
  .writing-content .prose.prose-lg h3,
  .writing-content .prose.prose-lg h4,
  .writing-content .prose.prose-lg h5,
  .writing-content .prose.prose-lg h6 {
    font-size: revert !important;
    margin-top: 1.5em !important;
    margin-bottom: 0.5em !important;
    line-height: 1.2 !important;
    color: hsl(var(--foreground)) !important;
    font-weight: 700 !important;
  }

  .writing-content .prose.prose-lg h3 { font-size: 1.75em !important; }
  .writing-content .prose.prose-lg h4 { font-size: 1.2em !important; }
  .writing-content .prose.prose-lg h5 { font-size: 1.25em !important; }
  .writing-content .prose.prose-lg h6 { font-size: 1.1em !important; }

  .writing-content .prose.prose-lg {
    font-size: inherit !important;
  }

</style>

</rewritten_file>